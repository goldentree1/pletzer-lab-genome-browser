/** ===== General ===== */

* {
  margin: 0;
  padding: 0;
}

*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  font-family:
    -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu',
    'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  color: #1e1e25;
  background-color: #f2f2f2;
}

code {
  font-family:
    source-code-pro, Menlo, Monaco, Consolas, 'Courier New', monospace;
}

select {
  min-width: 100px;
}

svg {
  display: block;
}

/** ===== Header / navigation ===== */

.header {
  display: flex;
  flex-direction: row;
  padding-inline: 0.37rem;
  padding-block: 0.15rem;
  gap: 0.5rem;
  background-color: white;
  justify-content: flex-start;
  box-shadow:
    0 6px 8px -1px rgb(0 0 0 / 0.125),
    0 4px 6px -2px rgb(0 0 0 / 0.125);
  color: #155b8e;

  overflow-x: auto;
  margin-bottom: 0.2rem;
}

.header-title {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.37rem;
  flex-shrink: 0;
}

.header-title img {
  background-color: #155b8e;
  border-radius: 2rem;
  padding: 0.2rem;
  width: 3.5rem;
  /*margin-right: 0.1rem;*/
  /*margin-block: 0.3rem;*/
  display: block;
}

.header-title h1 {
  font-size: 1.25rem;
  font-weight: 900;
  display: inline-block;
}

.header-nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  /*flex-grow: 1;*/
  /*gap: 0.3rem;*/
  flex-wrap: wrap;
  /** For dynamic vertical - but need to change gap property if used*/
  /*flex-wrap: wrap;*/
}
.header-nav > nav {
  padding-block: 0.3rem;
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.header-condition-chooser {
  display: flex;
  flex-direction: row;
  gap: 0.15rem;
  justify-content: center;
  align-items: center;
  /*margin: 0 auto;*/
  padding-inline: 0.25rem;
}

.header-condition-chooser > span {
  font-size: 0.75rem;
  font-weight: 800;
  margin-inline: 0.15rem;
  display: inline;
}

.extra-condition-button {
  display: block;
  border-radius: 100%;
  padding: 0.15rem;
  /*border: 1px solid gray;*/
  border: none;
  background: none;
  cursor: pointer;
}

.extra-condition-button > svg {
  color: #696969;
  transition:
    color 0.2s ease,
    transform 0.2s ease;
}

.extra-condition-button:hover svg {
  transform: scale(1.05);
}

.remove-condition-button:hover svg {
  color: red;
  transform: scale(1.05);
}

.add-condition-button:hover svg {
  color: limegreen;
  transform: scale(1.15);
}

.experiment-info-button svg {
  color: #155b8e;
}

.experiment-info-button:hover svg {
  color: dodgerblue;
  transform: scale(1.15);
}

.header-buttons-container {
  display: flex;
  align-items: center;
  min-width: 13rem;
  max-width: fit-content;

  /** Uncomment to get scroll behaviour on screen too small - currently just wraps instead*/
  /*flex: 1 1 0%;*/
  /*overflow: auto;*/
}

.header-buttons {
  display: flex;
  flex-direction: row;
  gap: 0.5rem;
  align-items: center;
  flex-shrink: 0;
  white-space: nowrap;
  background-color: #f5f5f5;
  border-radius: 0.37rem;
  border: 1px solid #cccccc;
  padding: 0.3rem 0.5rem;
  font-size: 0.8rem;
}

.header-buttons select {
  font-size: 0.7rem;
}

.header-buttons .checkbox {
  display: flex;
  gap: 0.15rem;
  justify-content: center;
  align-items: center;
}

/** ===== JBrowse customisations ===== */

.jbrowse-container {
  padding: 0rem 0rem;
}
.jbrowse-container > div > div,
.jbrowse-container > div {
  background-color: #e1e1e1 !important;
}

/**ridiculous hacks so jbrowse doesnt show it's logo and menu.
we 'can' remove logo, but menu would be confusing and unnecessary.
other option is to fork project, and i'm not quite that desperate yet. */
.jbrowse-container > div > div > div > div:first-child {
  min-height: 0.5rem;
}
.jbrowse-container > div > div > div > div:first-child > * {
  display: none;
}

/** steezy select stuff (has fallback if bad browser support) */
select {
  appearance: none;
  @supports (appearance: base-select) {
    @media (hover: hover) {
      &,
      &::picker(select) {
        appearance: base-select;
      }
    }
  }
}

select {
  font-size: 1rem;
  display: flex;
  justify-content: space-between;
  min-width: 350px;
  align-items: center;
  color: white;
  padding-block: 5px;
  padding-inline: 30px 40px;
  border-radius: 2rem;
  border: 2px solid #155b8e;
  cursor: pointer;
  font-weight: 600;
  background: #155b8e
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23FFF' class='size-6'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E%0A")
    right 10px center / 20px no-repeat;
  @media (hover: hover) {
    @supports (appearance: base-select) {
      padding-inline: 20px;
      background-image: none;
      &::picker-icon {
        content: '';
        width: 20px;
        height: 20px;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23FFF' class='size-6'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E%0A");
        transition: rotate 0.15s ease-out;
      }
      &:open::picker-icon {
        rotate: 180deg;
      }
      /* Update your &::picker(select) block */

      &::picker(select) {
        padding: 0;
        margin-top: 5px;
        border: 2px solid #155b8e;
        background: white;
        border-radius: 20px;
        font-weight: 400;

        opacity: 0;
        height: 0;
        overflow: clip;
        scrollbar-width: none;
        &::-webkit-scrollbar {
          display: none;
        }

        transition:
          height 0.3s ease-out,
          opacity 0.3s ease-in-out,
          overlay 0.3s,
          display 0.3s;

        transition-behavior: allow-discrete;
      }

      &:open::picker(select) {
        overflow: auto;
        opacity: 1;
        height: calc-size(auto, size);

        @starting-style {
          opacity: 0;
          height: 0;
          overflow: clip;
        }
      }

      optgroup {
        color: #155b8e;
      }
      option {
        padding: 15px 20px;
        border-top: 1px solid #155b8e;
        cursor: pointer;
        transition-property: color, background;
        transition-duration: 0.2s;
        transition-timing-function: ease-out;
        &:where(:hover, :focus, :active) {
          background: dodgerblue;
          color: white;
        }
        &:checked {
          background: #155b8e;
          color: white;
        }
        &::checkmark {
          display: none;
        }
        &:first-child {
          border: 0;
        }
      }
    }
  }
}

/* 1. THE SHARED LOGIC (Cleaned) */
select {
  appearance: none;
  -webkit-appearance: none;
  background-repeat: no-repeat;
  background-position: right 10px center;
  background-size: 18px; /* Fixed size for consistency */

  @supports (appearance: base-select) {
    @media (hover: hover) {
      &,
      &::picker(select) {
        appearance: base-select;
      }

      /* This is the key: Hide the background-image when the picker is active
         to prevent the "Double Arrow" ghosting. */
      background-image: none !important;

      &::picker-icon {
        content: '';
        width: 18px;
        height: 18px;
        transition: rotate 0.15s ease-out;
        background-size: contain;
        background-repeat: no-repeat;
      }

      &:open::picker-icon {
        rotate: 180deg;
      }

      &::picker(select) {
        /* ... keep your existing picker styling (borders, etc) ... */
        border: 2px solid #155b8e;
        background: white;
        border-radius: 20px;
      }
    }
  }
}

select {
  background-color: white;
  color: #155b8e;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23155b8e'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E");
  &::picker-icon {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23155b8e'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E");
  }
}

.genome-select {
  background-color: #155b8e;
  color: white;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23FFF'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E");
  &::picker-icon {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23FFF'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E");
  }
}

.pill-select {
  font-size: 0.78rem;
  background: white
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23155b8e'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")
    right 10px center / 18px no-repeat;
  border: 1px solid #155b8e;
  border-radius: 1.5rem;
  padding-block: 2px;
  padding-inline: 0.9rem 0.85rem;
  font-weight: 500;
  max-width: 190px;
  min-width: 190px;
}

.sq-select {
  font-size: 0.75rem;
  background: white
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%23155b8e'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")
    right 10px center / 18px no-repeat;
  border: 1px solid #155b8e;
  border-radius: 0.3rem;
  padding-block: 2px;
  padding-inline: 0.5rem 0.5rem;
  font-weight: 500;
  max-width: 115px;
  min-width: 115px;
}

.normalize-select {
  max-width: 70px;
  min-width: 70px;
}

/** I actually really like look of this, but we'd need to make it work on all selects */
/*.condition-select > optgroup {
  padding-inline: 0.2rem;
}*/

.pill-select > optgroup:first-child {
  padding-top: 0.37rem;
}

/** ===== DARK THEME =====*/
@media (prefers-color-scheme: dark) {
  html,
  body {
    color: white;
    background-color: #3a3a41;
  }

  input {
    color: black;
  }

  /** ===== Header / navigation ===== */

  .header {
    color: white;
    background-color: #2222;
  }

  .header label {
    color: #155b8e;
  }

  .header-title h1 {
    color: dodgerblue;
  }

  .checkbox {
    color: black;
  }

  /** ===== JBrowse customisations ===== */

  .jbrowse-container > div > div,
  .jbrowse-container > div {
    background-color: #3a3a41 !important;
  }
}
